\documentclass[a4paper,11pt]{article}

%%%%%%%%%
%%usees%%
%%%%%%%%%
\usepackage[utf8]{inputenc}
%\usepackage[ngerman]{babel}
%\usepackage{a4wide}
\usepackage[margin=3.0cm, top=3.0cm, bottom=3.0cm]{geometry}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{amssymb} 
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{footnote}
\usepackage{caption}
\usepackage{color}
\usepackage{hyperref}
\usepackage{cite}




%%%%%%%%%
%%Title%%
%%%%%%%%%
\author{Frederik Zwilling 304314}
\title{Bachelor-Thesis Proposal:\\ Multi-Robot Simulation of the RoboCup Logistic League with Fawkes and Gazebo}
\begin{document}
%\thispagestyle{empty}
%\tableofcontents
%\newpage
%\onehalfspace
\maketitle
%%%%%%%%%
%%Text%%
%%%%%%%%

\section{Introduction}
Autonomous robots are about to play an important role in the future of logistics and production. They are able to save time and cost in logistics and the industrial production process. Existing systems in the warehousing domain, such as~\cite{{Kiva}}, already show the potential of autonomous robots to boost efficiency in many ways. Especially multi-robot-systems have a huge potential in this context because they are able to do work distributed and in parallel, are efficient if they work together and are more reliable than single robots. Though, the development of multi-robot systems for logistics can be difficult because the robots have to handle many complex tasks. They have to detect objects, localize themselves, make a plan of what to do in which order, coordinate with other robots, optimize the work flow and be safe for humans and hardware all the time.\\
A key to effective and time saving development of reliable software for robots is simulation. Simulation makes it possible to test written code fast in different scenarios. This leads to a better quality of the software and better performance of the robot. By simulating the behaviour of a multi-robot system much time can be saved because there are no real robot which have to be set up and the simulation can quickly change between different scenarios. Simulation also enables testing if no real robots are available and can be easily used to compare different versions of the software. For example this can be useful to find unknown parameters such as thresholds.\\
The proposed bachelor-thesis will develop a multi-robot simulation environment for the \textit{Logistic League Sponsored by Festo} (LLSF) and the robot software framework \textit{Fawkes}\footnote{\url{http://www.fawkesrobotics.org}}. The multi-robot simulation primarily requires a simulation, that is able to properly simulate single robots. If this basis simulation works on a high level logic and a nearly physical level as well, most of the problems in the development of the robot system can be simulated. As a basis simulation, the open source simulator \textit{Gazebo} was chosen.\\
In the following the proposal shows the background of the thesis in section 2. Section 3 gives an overview of related work. There is shown with other simulators and multi-robot simulations exists and why gazebo was chosen as simulator for this thesis. Section 4 will present the proposed work in detail. It defines goals, gives a schedule and discusses how the evaluation of the thesis can be done. The conclusion is found in section 5.


%\subsection{Proposed Bachelor Thesis}
%\textcolor{red}{integrate in introduction and details}
%The primary goal of the proposed bachelor thesis is to develop a multi-robot simulation environment in Fawkes for the LLSF competition with Gazebo. This will speed up and simplify many current and future devselopments. Particularly robot coordination will be made easier because there the testing with real robots is even more difficult and time consuming. Some of the current developments will benefit from the simulation. The agent can easily be tested because its behavior is visually shown in  a realistic simulation. The current simulation for the high level agent is only text-based and does not simulate any actions on a lower level (e.g. all movement orders return that they succeeded). The laser-cluster-detector would benefit from the simulation because the laser data generated by Gazebo is relatively realistic\footnote{This has to be shown by the thesis, but it is intuitively right because laser sensors are quite accurate and a geometrical calculation by Gazebo is easy.} and it is possible to look at different situations much faster. Even the vision task can benefit from the simulation because the vision plugin can first be made working as a whole with simple images. The necessary vision tuning can then be done as a second step with an already tested structure it is embedded in. Of course simulation can never completely substitute testing on the real robot, but it can save a lot of time. This has many reasons. There is no need to get the real robots running what can take a lot of time in practice. The logic can be separately tested from real world problems which can not easily be simulated. Another advantage of the simulation is that the developers do not need to work on the same system.\\
%Structurally, the multi-robot simulation for LLSF will consist of Fawkes and Gazebo plugins and models for Gazebo. The interchangeability of plugins in Fawkes makes it possible that the simulation only needs to exchange the robot hardware plugins on the lowest level by robot simulation plugins. All plugins on upper levels do not need to be changed and can work in the simulation the same way as in reality. The models for Gazebo will represent all physical objects in the LLSF game (e.g. the Robotino and the Machines). The Gazebo plugins will control the behavior and sensing of all dynamic elements in the game (e.g. the Robotino and the Refbox).\\
%In the following the proposal will give an overview of related work in section 2. This section will be divided into the context the thesis is embedded in, other simulators and other multi-robot simulations. Section 3 will present the proposed work in detail with primary and further goals. Section 4 will give a schedule and in section 5 some methods of post-evaluation are proposed. The conclusion is found in section 6.

\section{Background}
\subsection{Logistic League Sponsored by Festo}
The Logistic League Sponsored by Festo (LLSF) is part of the \textit{RoboCup}, an international robotics competition founded in 1997. The RoboCup provides standard problems as a platform for artificial intelligence and robotics research~\cite{{Robocup}}. There are different leagues in the RoboCup. The main focus is on soccer leagues, but there are more leagues, such as the leagues for rescue, domestic and logistic robots. LLSF is one of those leagues. LLSF aims to foster scientific work on autonomous solutions for logistics. The participants should find new approaches and improve already existing ones to optimize material and information flow in logistics. LLSF takes place  in a simplified production hall. 
\begin{figure}
\centering
\includegraphics[scale=0.3]{pics/llsf}
\label{Figure 1}
\caption{A half of the LLSF field. Two Robotinos of the Carologistics team at the RoboCup German Open 2013}
\end{figure}
Figure 1 shows a part of the 5.6m x 5.6m hall with two Carologistic robots, three machines and some material-pucks. The robots are Robotinos by Festo~\cite{{Robotino}}. They hold omni-directional wheels, a gripper to move pucks, and other sensors added by the participants. The orange pucks represent resources and products. They are equipped with an RFID-chip\footnote{Radio-frequency identification allows the wireless identification of objects with small chips.} which is needed to store the different product states of the pucks. The light-signals on top of the RFID-readers represent the machines. They convert resources or semi-finished products into products and trash. There are different types of machines. They can produce different product-types, produce intermediate products, recycle trash or are used for the delivery of products. The light-signals on top of the machines indicate the machine-status. Beside these visual elements, there is also a referee box (Refbox), which controles the machines and communicates with the robots during the game. The Refbox gives orders which products are to be produced, informs the robots about the game state and rewards points for achieved goals.
\subsection{Fawkes}
\sloppy
Fawkes is an open source robot software framework developed by the Knowledge-based Systems Group\footnote{\url{http://www.kbsg.rwth-aachen.de/}} at RWTH Aachen University. It is written for Linux and follows a component-based software design~\cite{{FawkesDesign}}. It provides an infrastructure to load and unload binary components, implemented as plugins, at run-time and provides a blackboard for communication between the plugins. A plugin can access the blackboard via interfaces. Furthermore it organizes the plugin activity in threads to make use of multi-core architectures. Because of this design, Fawkes is flexible and dynamic. The interchangeability of the plugins, which is caused by the well defined interfaces, makes hardware abstraction and reuse easy. This is also an important advantage for the development of the simulation because the simulation can easily exchange the lower-level robot control and sense plugins. The robot control plugins on higher levels can operate as usual because the interface is the same.\\
In comparison to the Robot Operating System ROS~\cite{{Ros}} bla.
\subsection{Gazebo}
Gazebo is an open source multi-robot simulator~\cite{{GazeboDesign}}. It simulates the behavior of robots and other objects physically in a three dimensional world. The open source engine Ogre\footnote{\url{http://www.ogre3d.org}} is used for the graphical presentation of the simulation and allows realistic graphical environment. This is important for the simulation of camera sensors. Physics are simulated with the Open Dynamics Engine\footnote{\url{http://www.ode.org/}}. Gazebo was originally developed for outdoor applications and aims to simulate robots in a complex and realistic environment. Besides the physical simulation, it does this by generating data for different types of sensors. Gazebo can simulate laser range finders, cameras, sonar sensors, bumpers and more. This enables realistic simulation on a hardware-near level. A simulation in Gazebo is developed by creating robot and world models and developing Gazebo-plugins for behavior. These plugins can control objects in Gazebo and communicate with other software.\\
Why Gazebo was chosen as the most suitable simulator for this thesis is shown in the section about related work.
\section{Related Work}
\subsection{Existing Context}
The work of the proposed thesis is embedded in an already existing context of work. The Carologistics team\footnote{\url{http://trac.fawkesrobotics.org/wiki/Carologistics}} participates in the LLSF and is a joint team consisting of the Knowledge-based Systems Group at RWTH Aachen University, the IMA/ZLW \& IFU Institute Cluster at RWTH Aachen University and the Department for Electrical Engineering and Information Technology, Robotics Group at FH Aachen. The team has developed a working system for LLSF and participated in RoboCup 2012 in Mexico and RoboCup GermanOpen 2013. The next milestone will be the RoboCup 2013 in Eindhoven. Thus, there are many things to do. The skills and movement of the robot need to be made more robust. Communication and coordination between the Robotinos is necessary to produce with multiple robots at the same time and full system tests need to be done to ensure that all components work together. The work of Carologistics is based on Fawkes. It additionally uses ROS\footnote{\url{http://www.ros.org/}} for navigation.\\
Some work was already done on Gazebo for Fawkes. Bastian Klingen developed a scene reconstruction for fault analysis in his diploma thesis~\cite{{KlingenDA}}. The scenario was a mobile robot which has to pick up a colored cup with a gripper arm. During the execution of the picking-order, the motions, sensor data and belief of the robot are stored in a database. If the process fails, the scene reconstruction visualizes what happened from the robot's point of view to make fault analysis possible. \textcolor{red}{How fault analysis (tree).} The visualization uses Gazebo. In the implementation Klingen also made a general Gazebo-aspect for Fawkes. This can be used as a starting point for the proposed thesis and may be enchanted if it is necessary or useful.
\subsection{Comparison of Simulators}
This subsection presents an overview of the mainly used robot simulators that are able to simulate LLSF. Afterwards, it is reasoned why Gazebo is chosen as the most appropriate simulator for the thesis.
\subsubsection{Other Robot Simulators}
An often used robot simulator is \textit{Stage}\footnote{\url{http://playerstage.sourceforge.net/index.php?src=stage}}. It is part of the \textit{Player/Stage} project~\cite{{PlayerStage}} and provides an easy to use simulation environment, which can quickly be linked from Player, a robot control interface. Stage is an open source 2D-simulator and supports large populations of robots.\\
\textit{Robotino Sim Professional}\footnote{\url{http://www.festo-didactic.com/int-en/learning-systems/software-e-learning/robotino-sim-view/robotino-sim-professional.htm}} is a 3D-simulator for the Robotino developed by its manufacturer Festo. It is a commercial software and only usable on Microsoft Windows.\\
\textit{Webots}\footnote{\url{http://www.cyberbotics.com}} is a commercial 3D-simulator~\cite{{Webots}}. It is platform independent and can simulate several robots at the same time. Its API functions are available in many programming languages and the simulator has many different robot and environment objects models out of the box.\\
\textit{USARSim}~\cite{{USARSim}} was originally intended as an urban search and rescue simulation but it can also be used for other domains. It is platform independent, free of charge for research and education, and used in the Rescue Virtual Robot Competition within the RoboCufor \textit{Player}.\\
\textit{SIMRobot}\footnote{\url{http://www.informatik.uni-bremen.de/simrobot}} is an open source 3D-simulator and platform independent. It is used by multiple teams in the RoboCup~\cite{{SIMRobot}}. It has been developed by the University Bremen since 1994.\\
The \textit{Microsoft Robotics Developer Studio}\footnote{\url{http://www.microsoft.com/robotics}} is free for noncommercial use and bound to Microsoft Windows. Besides the simulation it offers standardization for robotic control and several tools for robot development~\cite{{MicrosoftRoboticsStudio}}.
\subsubsection{Advantages of the Gazebo Simulator}
The Gazebo simulator has many advantages for this thesis~\cite{{GazeboDesign}}. It is open source what makes it free to use and easy to edit if something is missing. For example \cite{{KlingenDA}} added the ability to drawing additional lines in the visualization to show a \textcolor{red}{coordinate system grid}. It is important that Gazebo is a 3D-simulator because camera sensors can not be simulated in a 2D simulator. The physics engine and realistic graphics are indispensable for a realistic simulation. It is possible in Gazebo to assign for example friction and reflection values to an object. So, even the problem of a reflecting ground can be simulated if you are developing a light-seeking vision program. However, it has to be figured out which level of realism is best for the simulation. For example the behavior of the omni-directional wheels might differ in a physically correct simulation. Other advantages are that Gazebo runs in Linux and has an active community and a beginner friendly documentation. Furthermore, it already includes many commonly used robot-models and sensors. Therefore, it is not often necessary to implement own sensor plugins. In addition to that, Gazebo seems to be well suited for future work. It is a general multi-robot simulator and is well funded by the Open Source Robotics Foundation\footnote{\url{http://osrfoundation.org/}} and Willow Garage\footnote{\url{http://www.willowgarage.com/}}. Besides that Gazebo was chosen as the basis for the \textit{DARPA Robotics Challenge Simulator 2013}\footnote{http://spectrum.ieee.org/automaton/robotics/robotics-software/darpa-robotics-challenge-simulation-software-open-source-robotics-foundation}. A more practical advantage of Gazebo is that some work was already done on Gazebo in Fawkes by~\cite{{KlingenDA}}.\\
There are not many disadvantages of Gazebo. One is that Gazebo can not handle a larger number of robots~\cite{{GazeboDesign}}. The complexity of the simulations limits the number of robots to the order of ten. This is no problem for this work because in LLSF there are only up to three robots and a control plugin for the machines at a time.
\subsection{Other Multi-Robot Simulations}
There are several other multi-robot simulation environments. \cite{{MultiLevelAbstraction}}~simulates the Middle-size Soccer League (MSL) of RoboCup and also works with Gazebo, but the communication is done with Player. In the MSL there are two teams with five robots under the size of 90 cm. Therefore, the simulation has to handle up to ten robots at once. In this work, similar equipment was simulated as used by Carologistics. \cite{{MultiLevelAbstraction}}~simulated prototypes of omni-directional wheels and an omni-vision camera. Figure 2 shows these two devices in the simulation.
\begin{figure}
\centering
\includegraphics[scale=0.5]{pics/GazeboEquipment}
\label{Figure 2}
\caption{An omni-directional wheel prototype built in Gazebo (left) and the simulated picture taken of an omni-vision camera (right)~\cite{{MultiLevelAbstraction}}.}
\end{figure}
The omni-directional wheels of the Robotino work in the same way, but have a different design that needs to be modeled. The omni-vision camera mounted on the Robotino of Carologistics is very similar to the camera on the soccer-robots. The Gazebo-plugin for this camera might be a help for this thesis. The main point of~\cite{{MultiLevelAbstraction}} is the multi-level abstraction of the simulation. That means that the simulation is able to simulate with different levels of complexity. For example, the simulation can simulate on the physical level, where the robot software has to do movements and sensing as in the real world, and on a high logical level, where the robot moves exactly like intended and the simulation tells the robot exactly where it is located. These different abstraction levels are also important for the proposed thesis because they make the simulation more flexible and are well suited as milestones of the development of the simulation. \cite{{MultiLevelAbstraction}}~also shows that the speed of the simulation is an important aspect. If the simulation does not run fast enough to simulate in real-time, the behavior of the simulated robots may change because many processes running on the agent measure the time themselves. \cite{{MultiLevelAbstraction}}~dealt with this problem by changing the source code of the robot-software to use the simulation time instead of the system time. This is also possible in Fawkes because all plugins can use the time provided by Fawkes.\\
Another related work is~\cite{{SurveillanceSystem}}. It uses Gazebo and Player to simulate a surveillance system with Pioneer3AT robots. In this system several robots have to monitor an outdoor area and find possible intruders. Therefore, the robots have to spread over the area and coordinate their movements. The simulation was important for the development of the system because it could quickly simulate different areas and situations.\\
The 3D-Soccer-Simulation League in the RoboCup uses Simspark as simulator\footnote{\url{http://www.robocupgermanopen.de/sites/default/files/rules_GO_2013_3Dsim.pdf}}. In this league two teams of eleven NAO robots each play in the simulation. The competition and comparison between the different approaches of multi-agent strategies make this league interesting for the thesis. There are some works such as~\cite{{SoccerChampion}} which show the capability of the simulator to simulate complex movements and agent architectures.

\section{Details of Work}
\subsection{Goals}
This section presents the goals of the thesis and how they will be reached in detail. Table 1 shows an overview of all goals and their level.

\begin{table}
\centering
\begin{tabular}{|r||p{10cm}|}
\hline
Minimum & \begin{itemize}
\item Simulation environment for LLSF
\item High level simulation (exact position, exact movement)
\item Low level simulation (laser and camera sensors, motor movement)
\item Execution of multiple and communicating agents in the simulation
\item Quantitative evaluation of simulation
\item Evaluation of robot behavior in simulation in comparison to reality
\item Simulation of LLSF challenges
\item More general simulation (with abstraction layer)
\end{itemize}\\ \hline
Additional & \begin{itemize}
\item Comparison of different multi-robot strategies
\end{itemize}\\
\hline
\end{tabular}
\label{Table 1}
\caption{Goals defined for the thesis. The additional goal will be worked on last depending on how mush time is left.}
\end{table}
Developing a simulation of LLSF means in detail to create a realistic environment in the simulation similar to Figure 1. The communication between Fawkes and Gazebo will be realized by using Google's Protocol Buffers\footnote{Commonly known as Protobuf. More information is available under \url{http://code.google.com/p/protobuf/}.}, a flexible and easy to use data exchange format. The main reason for this choise is that it is used for communication in the Gazebo API and in~\cite{{KlingenDA}}.\\
On the one hand the movement orders from Fawkes will be executed in Gazebo and on the other hand the Gazebo plugins will simulate the sensing and will send the data to Fawkes. These two sides of the simulation will be developed in different levels. In the higher level, Gazebo tells Fawkes the exact position of the simulated Robotino and all movement commands are executed exactly. In the lower level, the movement is realized by using the physics engine and only the rotation of the wheels is simulated. Fawkes receives only raw laser-data and captured images.\\
An important task of the thesis is the simulation of multiple robots controlled by separately running Fawkes instances in the same Gazebo environment at the same time. A global administrator plugin or a mechanism to map the Fawkes instances to the simulated Robotino plugins is necessary. The communication between the Fawkes instances has not to be simulated because the local network is available\footnote{This allows to run Fawkes and Gazebo on different machines and can be useful to test a already set up Robotino before a competition.}. The details of evaluation are discussed after the next section.\\
Achieving abstraction in the implementation is important, so other developments beside LLSF can benefit from this thesis. The approach is to build additional abstraction layers for Fawkes and Gazebo plugins which encapsulates the communication between Fawkes and Gazebo as well as other functionality that is not domain specific. This is done as a second step to achieve a working simulation quicker and to benefit from the knowledge gained in the first run. The multi-level abstraction similar to~\cite{{MultiLevelAbstraction}} follows after the implementation of the high and low level simulation. Afterwards, it should be possible to choose the detail-level of the simulation. Another goal is to simulate the technical challenges of LLSF. For example there is a \textit{Whac-A-Mole} challenge. A robot has to reach machines, which give a light signals, as fast as possible. This can be simulated by changing the behavior of the machines in the simulation environment. The comparison of different multi-robot strategies to solve the LLSF task is a long term goal of Carologistics. A efficient strategy has to be found and optimized to get good results in LLSF. The thesis can compare two strategies (e.g. Master-Slave job assigning or a job blackboard) to prepare further work and show the capabilities of the simulator. In which detail this can be done depends on the time left for the thesis.\\

\subsection{Implementation Structure}
As said before, the work will structurally consist of plugins for Gazebo and plugins for Fawkes. Similar to~\cite{{KlingenDA}} the Gazebo-plugins will be a robot-control plugin and an object-creator plugin. In addition, robot-sensor plugins and an LLSF-control plugin, which controls the machines and pucks to provide the LLSF game logic,  are needed. On the other side, there will be Fawkes plugins  for the sensors and for the Robotino to control the movements.

\subsection{Schedule}
\begin{table}
\centering
\includegraphics[scale=0.4]{pics/Schedule.png}
\label{Table 2}
\caption{Time-schedule}
\end{table}

The time-schedule of the thesis is shown in Table 2. There is enough buffer-time to handle unexpected problems or to go further, implement more features and reach higher goals. There are two weeks buffer on the practical level and two weeks after the writing. These buffers are this large due to the difficulty of estimating the needed time for the defined goals.

\subsection{Evaluation}
This section covers the evaluation of the proposed thesis. On the one hand a qualitative analysis on how well the simulation works from an obvious point of view and on the other hand a quantitative analysis of the performance and scalability of the simulation will be given.\\
The qualitative evaluation analyzes the functionality of the simulation and the realized features. It will evaluate which components and problem scenarios can be well simulated and where there are difficulties in the other problem scenarios. The aim of the evaluation is to compare the robot's behavior in the simulation to that in reality. To do this, it is necessary to look at the difference in the sensor data first because this may be the main cause for different behavior. Furthermore, the difference of multi-robot behavior needs to be analyzed. This will be more challenging because of the greater complexity.\\
In the quantitative evaluation the speed of the simulation is important because a difference between real-time and simulation-time can also cause differences in the behavior. The network latency can be a cause for difference in the coordination between the robots. Another part of the quantitative evaluation is to measure the CPU and memory usage. Because the thesis is about a multi-robot simulation, the scalability of the simulation has to be measured, too. This means to measure the simulation speed, CPU and memory usage in relation to the number of robots simulated.

\section{Conclusion}
The thesis proposed here will develop a multi-robot simulation environment for LLSF with Fawkes and Gazebo. It is the basis for efficient and quality-assured work of current and future developments. The simulation environment will concentrate on the LLSF league, which promotes research on logistic robotics to prepare a new logistical and industrial revolution. The proposal showed that Gazebo is well suited as simulator for this thesis and future work. A part of the thesis will be built on previous work by~\cite{{KlingenDA}} and~\cite{{MultiLevelAbstraction}}. The proposal also defined the main~goals in Table 1. The evaluation will look at qualitative and quantitative aspects to ensure the quality and performance of the simulation.\\
An important advantage of the thesis is the support future work. Although the simulation is primarily made for LLSF, it is also an important step for other developments because Gazebo can simulate almost every robot and other simulations can base on this thesis. Furthermore the proposal showed that a multi-robot simulator is a key to an effective development of multi-robot coordination.


\bibliographystyle{plain}
\bibliography{references}

\end{document}
